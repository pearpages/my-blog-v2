(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{204:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return p}));var r=t(3),a=t(7),i=(t(0),t(236)),o={slug:"using-environment-variables-in-react",title:"Using environment variables in react",author:"pere pages",author_image_url:"https://avatars2.githubusercontent.com/u/3802915?s=400&v=4",tags:["react","env"]},c={permalink:"/using-environment-variables-in-react",editUrl:"https://github.com/pearpages/my-blog/edit/master/blog/2021-03-12-using-environment-variables-in-react.md",source:"@site/blog/2021-03-12-using-environment-variables-in-react.md",description:"When working with React, environment variables are variables that are available through a global process.env Object. That global Object is provided by your environment through NodeJs. And because we don\u2019t have NodeJs in the browser, we\u2019re going to need webpack.",date:"2021-03-12T00:00:00.000Z",tags:[{label:"react",permalink:"/tags/react"},{label:"env",permalink:"/tags/env"}],title:"Using environment variables in react",readingTime:2.48,truncated:!1,prevItem:{title:"NPM tricks",permalink:"/npm-tricks"},nextItem:{title:"Object Oriented Design",permalink:"/object-oriented-design"}},s=[{value:"Method 1: Using npm scripts (thanks to webpack)",id:"method-1-using-npm-scripts-thanks-to-webpack",children:[{value:"package.json",id:"packagejson",children:[]},{value:"webpack config file",id:"webpack-config-file",children:[]},{value:"React",id:"react",children:[]}]},{value:"Method 2: Using an <code>.env</code> file to set environment variables",id:"method-2-using-an-env-file-to-set-environment-variables",children:[{value:"Webpack config file",id:"webpack-config-file-1",children:[]},{value:"Different environment variables for different environments",id:"different-environment-variables-for-different-environments",children:[]}]}],l={toc:s};function p(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"When working with ",Object(i.b)("strong",{parentName:"p"},"React"),", environment variables are variables that are available through a global ",Object(i.b)("inlineCode",{parentName:"p"},"process.env")," ",Object(i.b)("em",{parentName:"p"},"Object"),". That global Object is provided by your environment through ",Object(i.b)("strong",{parentName:"p"},"NodeJs"),". And because we don\u2019t have NodeJs in the browser, we\u2019re going to need ",Object(i.b)("strong",{parentName:"p"},"webpack"),"."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"using ",Object(i.b)("strong",{parentName:"li"},"npm scripts")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},".env")," file")),Object(i.b)("h2",{id:"method-1-using-npm-scripts-thanks-to-webpack"},"Method 1: Using npm scripts (thanks to webpack)"),Object(i.b)("h3",{id:"packagejson"},"package.json"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-json"},'{\n  scripts: {\n    "dev": "webpack --env.API_URL=http://localhost:8000 --config webpack.config.dev.js",\n    "build": "webpack --env.API_URL=https://www.myapi.com --config webpack.config.build.js"\n  }\n}\n')),Object(i.b)("h3",{id:"webpack-config-file"},"webpack config file"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"{process.env.API_URL}")," will be replaced when we compile our code. The problem is, we didn\u2019t tell webpack to compile those variables to real values. Let\u2019s do that in our webpack config file with the DefinePlugin webpack plugin:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"module.exports = (env) => {\n  // create a nice object from the env variable\n  const envKeys = Object.keys(env).reduce((prev, next) => {\n    prev[`process.env.${next}`] = JSON.stringify(env[next]);\n    return prev;\n  }, {});\n\n  return {\n    plugins: [\n      new webpack.DefinePlugin(envKeys)\n    ]\n  };\n};\n")),Object(i.b)("h3",{id:"react"},"React"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-jsx"},"const App = () => <h1>{process.env.API_URL}</h1>;\n")),Object(i.b)("h2",{id:"method-2-using-an-env-file-to-set-environment-variables"},"Method 2: Using an ",Object(i.b)("inlineCode",{parentName:"h2"},".env")," file to set environment variables"),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"To prevent people from finding out your local database password is the same one you use for every single one of your accounts on the internet , add the ",Object(i.b)("inlineCode",{parentName:"p"},".env")," file to your ",Object(i.b)("inlineCode",{parentName:"p"},".gitignore"),"."))),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-.env"},"API_URL=http://localhost:8000\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"$ npm install --save-dev dotenv\n")),Object(i.b)("h3",{id:"webpack-config-file-1"},"Webpack config file"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const webpack = require('webpack');\nconst dotenv = require('dotenv');\n\nmodule.exports = () => {\n  // call dotenv and it will return an Object with a parsed key \n  const env = dotenv.config().parsed;\n  \n  // reduce it to a nice object, the same as before\n  const envKeys = Object.keys(env).reduce((prev, next) => {\n    prev[`process.env.${next}`] = JSON.stringify(env[next]);\n    return prev;\n  }, {});\n\n  return {\n    plugins: [\n      new webpack.DefinePlugin(envKeys)\n    ]\n  };\n};\n")),Object(i.b)("h3",{id:"different-environment-variables-for-different-environments"},"Different environment variables for different environments"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},".env")," (",Object(i.b)("strong",{parentName:"li"},"production"),")"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},".env.development")," (",Object(i.b)("strong",{parentName:"li"},"development"),")")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-json"},'{\n  "scripts": {\n    "dev": "webpack --env.ENVIRONMENT=development --config webpack.config.dev.js",\n    "build": "webpack --env.ENVIRONMENT=production --config webpack.config.build.js"\n  }\n}\n')),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const webpack = require('webpack');\nconst dotenv = require('dotenv');\nconst fs = require('fs'); // to check if the file exists\nconst path = require('path'); // to get the current path\n\nmodule.exports = (env) => {\n  // Get the root path (assuming your webpack config is in the root of your project!)\n  const currentPath = path.join(__dirname);\n  \n  // Create the fallback path (the production .env)\n  const basePath = currentPath + '/.env';\n\n  // We're concatenating the environment name to our filename to specify the correct env file!\n  const envPath = basePath + '.' + env.ENVIRONMENT;\n\n  // Check if the file exists, otherwise fall back to the production .env\n  const finalPath = fs.existsSync(envPath) ? envPath : basePath;\n\n  // Set the path parameter in the dotenv config\n  const fileEnv = dotenv.config({ path: finalPath }).parsed;\n  \n  // reduce it to a nice object, the same as before (but with the variables from the file)\n  const envKeys = Object.keys(fileEnv).reduce((prev, next) => {\n    prev[`process.env.${next}`] = JSON.stringify(fileEnv[next]);\n    return prev;\n  }, {});\n\n  return {\n    plugins: [\n      new webpack.DefinePlugin(envKeys)\n    ]\n  };\n")),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://trekinbami.medium.com/using-environment-variables-in-react-6b0a99d83cf5"},"Using environment variables in React")))}p.isMDXComponent=!0},236:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return d}));var r=t(0),a=t.n(r);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=a.a.createContext({}),p=function(e){var n=a.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},b=function(e){var n=p(e.components);return a.a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},v=a.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(t),v=r,d=b["".concat(o,".").concat(v)]||b[v]||u[v]||i;return t?a.a.createElement(d,c(c({ref:n},l),{},{components:t})):a.a.createElement(d,c({ref:n},l))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=v;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=t[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,t)}v.displayName="MDXCreateElement"}}]);